parameters:
  - name: configuration
    type: string

steps:
  - template: checkout.yml

  - script: |
      sudo wget -qO /usr/local/bin/ninja.gz https://github.com/ninja-build/ninja/releases/latest/download/ninja-linux.zip
      sudo gunzip /usr/local/bin/ninja.gz
      sudo chmod a+x /usr/local/bin/ninja
    displayName: 'Install ninja'

  - task: CMake@1
    displayName: 'build LibSSL'
    inputs:
      workingDirectory: './Build/libssl.Linux/build'
      cmakeArgs: '-S ./Utilities/CMake/Linux/openssl/libssl -B ./Build/libssl.Linux/build -D CMAKE_BUILD_TYPE=${{ parameters.configuration }} -G "Ninja"'

  - task: CMake@1
    displayName: 'build LibCrypto'
    inputs:
      workingDirectory: './Build/libcrypto.Linux/build'
      cmakeArgs: '-S ./Utilities/CMake/Linux/openssl/libcrypto -B ./Build/libcrypto.Linux/build -D CMAKE_BUILD_TYPE=${{ parameters.configuration }} -G "Ninja"'

  - task: CMake@1
    displayName: 'build LibHttpClient'
    inputs:
      workingDirectory: './Build/libHttpClient.Linux.C/build'
      cmakeArgs: '-S ./Utilities/CMake/Linux/openssl/libHttpClient -B ./Build/libHttpClient.Linux.C/build -D CMAKE_BUILD_TYPE=${{ parameters.configuration }} -G "Ninja"'